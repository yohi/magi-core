# MAGI System

<div align="center">

![MAGI System Logo](https://img.shields.io/badge/MAGI-System-purple?style=for-the-badge)
![Python](https://img.shields.io/badge/Python-3.11+-blue?style=flat-square&logo=python)
![License](https://img.shields.io/badge/License-MIT-green?style=flat-square)
![Version](https://img.shields.io/badge/Version-0.1.0-orange?style=flat-square)

**3è³¢è€…ã«ã‚ˆã‚‹åˆè­°ãƒ—ãƒ­ã‚»ã‚¹ã‚’é€šã˜ã¦ã€å¤šè§’çš„ã§ä¿¡é ¼æ€§ã®é«˜ã„åˆ¤æ–­ã‚’æä¾›ã™ã‚‹AIé–‹ç™ºãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ **

</div>

---

## æ¦‚è¦

MAGIã‚·ã‚¹ãƒ†ãƒ ã¯ã€ã‚¢ãƒ‹ãƒ¡ã€Œã‚¨ãƒ´ã‚¡ãƒ³ã‚²ãƒªã‚ªãƒ³ã€ã«ç™»å ´ã™ã‚‹MAGIã‚·ã‚¹ãƒ†ãƒ ã‚’ã€å®Ÿç”¨çš„ãªã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°ãƒ»ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã¨ã—ã¦å†æ§‹ç¯‰ã—ãŸãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã™ã€‚

å¾“æ¥ã®å˜ä¸€ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã«ã‚ˆã‚‹AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆé–‹ç™ºã‹ã‚‰è„±å´ã—ã€ã€Œ**åˆè­°åˆ¤å®šã‚³ã‚¢ï¼ˆCoreï¼‰**ã€ã¨ã€Œ**æ©Ÿèƒ½æ‹¡å¼µï¼ˆPluginsï¼‰**ã€ã‚’åˆ†é›¢ã™ã‚‹ã“ã¨ã§ã€ä¿å®ˆæ€§ã€å°‚é–€æ€§ã€æ‹¡å¼µæ€§ã‚’æ‹…ä¿ã™ã‚‹æ¬¡ä¸–ä»£ã®AIé–‹ç™ºç’°å¢ƒã‚’æä¾›ã—ã¾ã™ã€‚

### ğŸš€ ç‰¹å¾´

*   **ãƒãƒ«ãƒãƒ¢ãƒ‡ãƒ«åˆè­° (Multi-Model Consensus)**: å„è³¢è€…ã«ç•°ãªã‚‹LLMï¼ˆä¾‹: è«–ç†æ‹…å½“ã«GPT-4ã€é€Ÿåº¦æ‹…å½“ã«GPT-4o miniï¼‰ã‚’å‰²ã‚Šå½“ã¦ã€ã‚³ã‚¹ãƒˆã¨ç²¾åº¦ã®ãƒãƒ©ãƒ³ã‚¹ã‚’æœ€é©åŒ–ã€‚
*   **ãƒãƒ«ãƒãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼å¯¾å¿œ**: Anthropic Claude, OpenAI, GitHub Copilot, Google Gemini, Antigravity ãªã©ã€ä¸»è¦ãªLLMãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã‚’ã‚µãƒãƒ¼ãƒˆã€‚
*   **ãƒ—ãƒ©ã‚°ã‚¤ãƒ³æ‹¡å¼µ**: ä»•æ§˜æ›¸ç”Ÿæˆã‚„ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ãªã©ã€ç‰¹å®šã®ã‚¿ã‚¹ã‚¯ã«ç‰¹åŒ–ã—ãŸæ©Ÿèƒ½ã‚’ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¨ã—ã¦è¿½åŠ å¯èƒ½ã€‚

### ğŸ­ 3è³¢è€…ï¼ˆThree Magiï¼‰

| ãƒšãƒ«ã‚½ãƒŠ | å½¹å‰² | ç‰¹æ€§ | æ¨å¥¨ãƒ¢ãƒ‡ãƒ«ä¾‹ |
|---------|------|------|------------|
| **MELCHIOR-1** | è«–ç†ãƒ»ç§‘å­¦ | è«–ç†çš„æ•´åˆæ€§ã¨äº‹å®Ÿã«åŸºã¥ã„ãŸåˆ†æã‚’è¡Œã† | GPT-4o, Claude 3.5 Sonnet |
| **BALTHASAR-2** | å€«ç†ãƒ»ä¿è­· | ãƒªã‚¹ã‚¯å›é¿ã¨ç¾çŠ¶ç¶­æŒã‚’å„ªå…ˆã™ã‚‹ | GPT-4 Turbo, Claude 3 Opus |
| **CASPER-3** | æ¬²æœ›ãƒ»å®Ÿåˆ© | ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®åˆ©ç›Šã¨åŠ¹ç‡ã‚’æœ€å„ªå…ˆã™ã‚‹ | GPT-4o mini, Haiku |

### ğŸ“Š åˆè­°ãƒ—ãƒ­ãƒˆã‚³ãƒ«ï¼ˆConsensus Protocolï¼‰

MAGIã‚·ã‚¹ãƒ†ãƒ ã¯ä»¥ä¸‹ã®3ãƒ•ã‚§ãƒ¼ã‚ºã§åˆè­°ã‚’è¡Œã„ã¾ã™ï¼š

```mermaid
graph LR
    A[Thinking Phase] --> B[Debate Phase] --> C[Voting Phase]
    A --> |ç‹¬ç«‹æ€è€ƒ| A1[MELCHIORæ€è€ƒ]
    A --> |ç‹¬ç«‹æ€è€ƒ| A2[BALTHASARæ€è€ƒ]
    A --> |ç‹¬ç«‹æ€è€ƒ| A3[CASPERæ€è€ƒ]
    C --> |åˆ¤å®š| D{APPROVE / DENY / CONDITIONAL}
```

1. **Thinking Phase**: å„ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒç‹¬ç«‹ã—ã¦æ€è€ƒã‚’ç”Ÿæˆ
2. **Debate Phase**: ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆé–“ã§è­°è«–ãƒ»åè«–
3. **Voting Phase**: æŠ•ç¥¨ã«ã‚ˆã‚‹æœ€çµ‚åˆ¤å®šï¼ˆAPPROVE / DENY / CONDITIONALï¼‰

## ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

### å‰ææ¡ä»¶

- Python 3.11ä»¥ä¸Š
- [uv](https://github.com/astral-sh/uv) ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼

### ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

```bash
# ãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¯ãƒ­ãƒ¼ãƒ³
git clone https://github.com/yohi/magi-core.git
cd magi-core

# uvã§ä¾å­˜é–¢ä¿‚ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
uv sync

# ç’°å¢ƒå¤‰æ•°ã®è¨­å®š
export MAGI_API_KEY="your-anthropic-api-key"

# å‹•ä½œç¢ºèª
uv run magi --version
```

### PyPI ã‹ã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆå°†æ¥å¯¾å¿œäºˆå®šï¼‰

```bash
pip install magi-system
```

## ä½¿ç”¨æ–¹æ³•

### åŸºæœ¬ã‚³ãƒãƒ³ãƒ‰

```bash
# ãƒ˜ãƒ«ãƒ—ã‚’è¡¨ç¤º
magi --help

# ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’è¡¨ç¤º
magi --version

# è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ç”Ÿæˆ
magi init

# 3è³¢è€…ã«è³ªå•
magi ask "ã“ã®ã‚³ãƒ¼ãƒ‰ã‚’ãƒ¬ãƒ“ãƒ¥ãƒ¼ã—ã¦ãã ã•ã„"

# èªè¨¼ï¼ˆGoogle/Antigravity, Claude, etc.ï¼‰
magi auth login antigravity

# ä»•æ§˜æ›¸ã®ä½œæˆã¨ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ˆãƒ—ãƒ©ã‚°ã‚¤ãƒ³ä½¿ç”¨ï¼‰
magi spec "ãƒ­ã‚°ã‚¤ãƒ³æ©Ÿèƒ½ã®ä»•æ§˜æ›¸ã‚’ä½œæˆ"
```

### ã‚ªãƒ—ã‚·ãƒ§ãƒ³

| ã‚ªãƒ—ã‚·ãƒ§ãƒ³ | èª¬æ˜ | ä¾‹ |
|------------|------|-----|
| `-h, --help` | ãƒ˜ãƒ«ãƒ—ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º | `magi --help` |
| `-v, --version` | ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±ã‚’è¡¨ç¤º | `magi --version` |
| `--format <format>` | å‡ºåŠ›å½¢å¼ã‚’æŒ‡å®šï¼ˆjson, markdownï¼‰ | `magi --format json ask "..."` |
| `--plugin <name>` | ä½¿ç”¨ã™ã‚‹ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’æŒ‡å®š | `magi --plugin my-plugin spec "..."` |

### ä½¿ç”¨ä¾‹

```bash
# JSONå½¢å¼ã§å‡ºåŠ›
magi --format json ask "ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã®ææ¡ˆã‚’ã—ã¦ãã ã•ã„"

# ç‰¹å®šã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ä½¿ç”¨
magi --plugin magi-cc-sdd-plugin spec "APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®ä»•æ§˜æ›¸"

# Debateãƒ©ã‚¦ãƒ³ãƒ‰æ•°ã‚’ç’°å¢ƒå¤‰æ•°ã§æŒ‡å®š
MAGI_DEBATE_ROUNDS=3 magi ask "ã“ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®å•é¡Œç‚¹ã¯ï¼Ÿ"
```

## WebUIæ©Ÿèƒ½ (Preview)

MAGIã‚·ã‚¹ãƒ†ãƒ ã®åˆè­°ãƒ—ãƒ­ã‚»ã‚¹ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§å¯è¦–åŒ–ã™ã‚‹Webã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’æä¾›ã—ã¦ã„ã¾ã™ã€‚
ç¾åœ¨ã¯é–‹ç™ºè€…å‘ã‘ã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ©Ÿèƒ½ã¨ã—ã¦åˆ©ç”¨å¯èƒ½ã§ã™ã€‚

### èµ·å‹•æ–¹æ³•

Docker Composeã‚’ä½¿ç”¨ã—ã¦ã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã¨ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚’ä¸€æ‹¬ã§èµ·å‹•ã§ãã¾ã™ã€‚

```bash
docker compose up --build
```

èµ·å‹•å¾Œã€ãƒ–ãƒ©ã‚¦ã‚¶ã§ä»¥ä¸‹ã®URLã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ãã ã•ã„ã€‚

- URL: `http://localhost:3000`

## è¨­å®š

### ç’°å¢ƒå¤‰æ•°

| å¤‰æ•°å | èª¬æ˜ | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ |
|--------|------|-----------|
| `MAGI_API_KEY` | Anthropic APIã‚­ãƒ¼ï¼ˆ**å¿…é ˆ**ï¼‰ | - |
| `MAGI_MODEL` | ä½¿ç”¨ã™ã‚‹LLMãƒ¢ãƒ‡ãƒ« | `claude-sonnet-4-20250514` |
| `MAGI_DEBATE_ROUNDS` | Debateãƒ•ã‚§ãƒ¼ã‚ºã®ãƒ©ã‚¦ãƒ³ãƒ‰æ•° | `1` |
| `MAGI_VOTING_THRESHOLD` | æŠ•ç¥¨é–¾å€¤ï¼ˆmajority/unanimousï¼‰ | `majority` |
| `MAGI_TIMEOUT` | APIã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆï¼ˆç§’ï¼‰ | `60` |

### è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆmagi.yamlï¼‰

`magi init` ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã«è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®é››å½¢ (`magi.yaml`) ãŒç”Ÿæˆã•ã‚Œã¾ã™ã€‚
å„è³¢è€…ã«ç•°ãªã‚‹ãƒ¢ãƒ‡ãƒ«ã‚’å‰²ã‚Šå½“ã¦ã‚‹ã“ã¨ã§ã€ã‚³ã‚¹ãƒˆãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã¨ç²¾åº¦ã®æœ€é©åŒ–ãŒå¯èƒ½ã§ã™ã€‚

```yaml
# magi.yaml (Global Settings)
model: claude-sonnet-4-20250514
debate_rounds: 2
voting_threshold: majority
output_format: markdown
timeout: 120
retry_count: 3

# ãƒšãƒ«ã‚½ãƒŠå€‹åˆ¥è¨­å®š (Persona Overrides)
# å„è³¢è€…ã®å½¹å‰²ã«åˆã‚ã›ã¦æœ€é©ãªãƒ¢ãƒ‡ãƒ«ã¨ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è¨­å®šã—ã¾ã™
personas:
  melchior:
    llm:
      model: claude-3-opus-20240229  # è«–ç†æ‹…å½“ã«ã¯æœ€é«˜ç²¾åº¦ã®ãƒ¢ãƒ‡ãƒ«
      temperature: 0.0            # å³å¯†ãªè«–ç†çš„æ•´åˆæ€§ã®ãŸã‚ã«æ±ºå®šè«–çš„ã«
  casper:
    llm:
      model: gpt-4o-mini          # å®Ÿåˆ©æ‹…å½“ã«ã¯é«˜é€Ÿãƒ»ä½ã‚³ã‚¹ãƒˆãªãƒ¢ãƒ‡ãƒ«
      timeout: 180                # è¤‡é›‘ãªå‡¦ç†ã®ãŸã‚ã«ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã‚’å»¶é•·
# å€‹åˆ¥è¨­å®šãŒãªã„é …ç›®ï¼ˆBalthasarç­‰ï¼‰ã¯ã‚°ãƒ­ãƒ¼ãƒãƒ«è¨­å®šãŒä½¿ç”¨ã•ã‚Œã¾ã™
```

### ãƒãƒ«ãƒãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼èªè¨¼ (Multi-Provider Authentication)

MAGIã‚·ã‚¹ãƒ†ãƒ ã¯ `claude` (Anthropic), `copilot` (GitHub Copilot), `antigravity` (Google OAuth) ã®å„ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚
èªè¨¼ãƒˆãƒ¼ã‚¯ãƒ³ã¯ OS ã®ã‚­ãƒ¼ã‚¹ãƒˆã‚¢ (`keyring`) ã‚’ä½¿ç”¨ã—ã¦å®‰å…¨ã«ä¿å­˜ã•ã‚Œã¾ã™ã€‚

#### èªè¨¼ã‚³ãƒãƒ³ãƒ‰

```bash
# èªè¨¼ãƒ—ãƒ­ãƒã‚¤ãƒ€ã‚’é¸æŠã—ã¦ãƒ­ã‚°ã‚¤ãƒ³ï¼ˆãƒ–ãƒ©ã‚¦ã‚¶èªè¨¼ï¼‰
magi auth login antigravity

# ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ
magi auth logout antigravity

# èªè¨¼çŠ¶æ…‹ã®ç¢ºèª
magi auth status
```

#### è¨­å®šä¾‹ (magi.yaml)

`magi init` ã§ç”Ÿæˆã•ã‚Œã‚‹è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã«ã¯ã€ä¸»è¦ãªãƒ—ãƒ­ãƒã‚¤ãƒ€ã®è¨­å®šä¾‹ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚

**Antigravity (Google OAuth):**
```yaml
providers:
  antigravity:
    model: ag-model-v1
    # Client ID / Secret ã¯å¿…é ˆã§ã™ã€‚
    # magi auth login å®Ÿè¡Œæ™‚ã«å¯¾è©±çš„ã«å…¥åŠ›ã™ã‚‹ã‹ã€ã“ã“ã«ç›´æ¥è¨˜è¿°ã—ã¦ãã ã•ã„ã€‚
    # options:
    #   client_id: "your-google-client-id"
    #   client_secret: "your-google-client-secret"
    #   project_id: "your-google-cloud-project-id" # ç’°å¢ƒå¤‰æ•° ANTIGRAVITY_PROJECT_ID ã§ã‚‚æŒ‡å®šå¯èƒ½
```

**GitHub Copilot:**
```yaml
providers:
  copilot:
    model: gpt-4
    options:
      client_id: "Iv1.b507a08c87ecfe98" # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚ã‚Š
```

### ãƒ‘ã‚¹ã‚¹ãƒ«ãƒ¼æ©Ÿèƒ½ (Model Pass-Through)

ä»¥ä¸‹ã®ãƒ—ãƒ­ãƒã‚¤ãƒ€ãŠã‚ˆã³ãƒ¢ãƒ‡ãƒ«ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æŒ‡å®šã—ãŸå ´åˆã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯å¤‰æ›ã•ã‚Œãšã«ãã®ã¾ã¾å¯¾è±¡APIã¸è»¢é€ã•ã‚Œã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€æœ€æ–°ãƒ¢ãƒ‡ãƒ«ã‚„ç‰¹å®šã®ãƒ¢ãƒ‡ãƒ«IDã‚’å³åº§ã«åˆ©ç”¨å¯èƒ½ã§ã™ã€‚

- **OpenAI**: `gpt-`, `o1-` ~ `o9-`, `chatgpt-`, `codex` ã§å§‹ã¾ã‚‹ãƒ¢ãƒ‡ãƒ«ID
- **Google / Antigravity**: `gemini-`, `antigravity` ã§å§‹ã¾ã‚‹ãƒ¢ãƒ‡ãƒ«ID
- **Anthropic**: ãã®ä»–ã®ãƒ¢ãƒ‡ãƒ«IDã¯Anthropicã¨ã—ã¦å‡¦ç†ã•ã‚Œã¾ã™

ä¾‹: `gpt-4o`, `gemini-2.0-flash-exp`, `o1-preview` ãªã©ã¯è¨­å®šãªã—ã§ãã®ã¾ã¾åˆ©ç”¨å¯èƒ½ã§ã™ã€‚

---

## ãƒ—ãƒ©ã‚°ã‚¤ãƒ³é–‹ç™º

### ãƒ—ãƒ©ã‚°ã‚¤ãƒ³æ§‹é€ 

```
plugins/
â””â”€â”€ my-plugin/
    â””â”€â”€ plugin.yaml
```

### plugin.yaml ã‚¹ã‚­ãƒ¼ãƒ

```yaml
plugin:
  name: my-plugin              # ãƒ—ãƒ©ã‚°ã‚¤ãƒ³åï¼ˆå¿…é ˆï¼‰
  version: "1.0.0"             # ãƒãƒ¼ã‚¸ãƒ§ãƒ³ï¼ˆä»»æ„ï¼‰
  description: "èª¬æ˜æ–‡"         # èª¬æ˜ï¼ˆå¿…é ˆï¼‰

bridge:
  command: my-command          # å®Ÿè¡Œã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ï¼ˆå¿…é ˆï¼‰
  interface: stdio             # ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ç¨®åˆ¥ï¼ˆstdio/fileï¼‰
  timeout: 30                  # ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆç§’æ•°

agent_overrides:
  melchior: |                  # MELCHIORå‘ã‘ã®è¿½åŠ æŒ‡ç¤º
    ... å°‚é–€çš„ãªæŒ‡ç¤º ...
  balthasar: |                 # BALTHASARå‘ã‘ã®è¿½åŠ æŒ‡ç¤º
    ... å°‚é–€çš„ãªæŒ‡ç¤º ...
  casper: |                    # CASPERå‘ã‘ã®è¿½åŠ æŒ‡ç¤º
    ... å°‚é–€çš„ãªæŒ‡ç¤º ...
```

### ã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ï¼ˆmagi-cc-sdd-pluginï¼‰

ä»•æ§˜æ›¸é§†å‹•é–‹ç™ºï¼ˆSDDï¼‰ã®ãŸã‚ã®ã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒ `plugins/magi-cc-sdd-plugin/` ã«å«ã¾ã‚Œã¦ã„ã¾ã™ï¼š

```bash
# SDDãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ä½¿ç”¨ã—ã¦ä»•æ§˜æ›¸ã‚’ä½œæˆ
magi spec "ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼APIã®ä»•æ§˜æ›¸ã‚’ä½œæˆã—ã¦ãã ã•ã„"
```

ã“ã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¯ï¼š
- `cc-sdd` ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ä»•æ§˜æ›¸ã‚’ç”Ÿæˆ
- å„ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«ä»•æ§˜æ›¸ãƒ¬ãƒ“ãƒ¥ãƒ¼å°‚ç”¨ã®æŒ‡ç¤ºã‚’æ³¨å…¥
- è«–ç†çš„æ•´åˆæ€§ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒªã‚¹ã‚¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¾¡å€¤ã®è¦³ç‚¹ã‹ã‚‰ãƒ¬ãƒ“ãƒ¥ãƒ¼

## é–‹ç™º

è©³ç´°ãªé–‹ç™ºã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ï¼ˆã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„ã€è¨€èªãƒãƒªã‚·ãƒ¼ç­‰ï¼‰ã«ã¤ã„ã¦ã¯ [AGENTS.md](AGENTS.md) ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

### é–‹ç™ºç’°å¢ƒã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

```bash
# ãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¯ãƒ­ãƒ¼ãƒ³
git clone https://github.com/yohi/magi-core.git
cd magi-core

# é–‹ç™ºä¾å­˜é–¢ä¿‚ã‚’å«ã‚ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
uv sync

# ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œ
uv run python -m unittest discover -s tests -v
```

### ãƒ†ã‚¹ãƒˆ

```bash
# ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ
uv run python -m unittest discover -s tests/unit -v

# ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãƒ™ãƒ¼ã‚¹ãƒ†ã‚¹ãƒˆï¼ˆHypothesisï¼‰
uv run python -m unittest discover -s tests/property -v

# çµ±åˆãƒ†ã‚¹ãƒˆ
uv run python -m unittest discover -s tests/integration -v

# å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
uv run python -m unittest discover -s tests -v

# ç‰¹å®šã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã‚’å®Ÿè¡Œ
uv run python -m unittest tests.unit.test_cli.TestArgumentParser.test_parse_help_short

# ã‚«ãƒãƒ¬ãƒƒã‚¸ä»˜ããƒ†ã‚¹ãƒˆ
uv run coverage run -m unittest discover -s tests
uv run coverage report
uv run coverage html  # HTMLãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
```

### ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ 

```
magi-core/
â”œâ”€â”€ src/
â”‚   â””â”€â”€ magi/
â”‚       â”œâ”€â”€ __main__.py          # CLIã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ (magi ã‚³ãƒãƒ³ãƒ‰)
â”‚       â”œâ”€â”€ models.py            # å…±é€šãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ« (dataclass, Enum)
â”‚       â”œâ”€â”€ errors.py            # ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ãƒ»ä¾‹å¤–éšå±¤
â”‚       â”œâ”€â”€ agents/              # ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚·ã‚¹ãƒ†ãƒ 
â”‚       â”‚   â”œâ”€â”€ persona.py       # ãƒšãƒ«ã‚½ãƒŠç®¡ç†
â”‚       â”‚   â””â”€â”€ agent.py         # ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå®Ÿè£… (think/debate/vote)
â”‚       â”œâ”€â”€ cli/                 # CLIãƒ¬ã‚¤ãƒ¤ãƒ¼
â”‚       â”‚   â”œâ”€â”€ parser.py        # å¼•æ•°ãƒ‘ãƒ¼ã‚µãƒ¼
â”‚       â”‚   â”œâ”€â”€ main.py          # MagiCLI
â”‚       â”‚   â””â”€â”€ model_fetcher.py # ãƒ¢ãƒ‡ãƒ«ä¸€è¦§å–å¾—
â”‚       â”œâ”€â”€ config/              # è¨­å®šç®¡ç†
â”‚       â”‚   â”œâ”€â”€ manager.py       # ConfigManager
â”‚       â”‚   â”œâ”€â”€ provider.py      # ProviderConfigLoader (ãƒãƒ«ãƒãƒ—ãƒ­ãƒã‚¤ãƒ€)
â”‚       â”‚   â””â”€â”€ settings.py      # MagiSettings (Pydantic V2 BaseSettings)
â”‚       â”œâ”€â”€ core/                # ã‚³ã‚¢ã‚¨ãƒ³ã‚¸ãƒ³ãƒ»ãƒãƒ¼ãƒ‰ãƒ‹ãƒ³ã‚°
â”‚       â”‚   â”œâ”€â”€ consensus.py     # åˆè­°ã‚¨ãƒ³ã‚¸ãƒ³ (async)
â”‚       â”‚   â”œâ”€â”€ context.py       # ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆç®¡ç†
â”‚       â”‚   â”œâ”€â”€ concurrency.py   # ConcurrencyController (Semaphore)
â”‚       â”‚   â”œâ”€â”€ streaming.py     # QueueStreamingEmitter
â”‚       â”‚   â”œâ”€â”€ token_budget.py  # ãƒˆãƒ¼ã‚¯ãƒ³äºˆç®—ç®¡ç†
â”‚       â”‚   â”œâ”€â”€ quorum.py        # ã‚¯ã‚ªãƒ¼ãƒ©ãƒ ãƒ»ãƒ•ã‚§ã‚¤ãƒ«ã‚»ãƒ¼ãƒ•åˆ¤å®š
â”‚       â”‚   â”œâ”€â”€ schema_validator.py # JSONã‚¹ã‚­ãƒ¼ãƒæ¤œè¨¼
â”‚       â”‚   â”œâ”€â”€ template_loader.py  # ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå¤–éƒ¨åŒ–ãƒ»ã‚­ãƒ£ãƒƒã‚·ãƒ¥
â”‚       â”‚   â”œâ”€â”€ spec_sync.py     # spec.json/tasks.md åŒæœŸ
â”‚       â”‚   â””â”€â”€ providers.py     # ãƒ—ãƒ­ãƒã‚¤ãƒ€ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆå®šç¾©
â”‚       â”œâ”€â”€ llm/                 # LLMé€šä¿¡
â”‚       â”‚   â”œâ”€â”€ client.py        # LLMClient å…±é€šã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
â”‚       â”‚   â”œâ”€â”€ providers.py     # ãƒ—ãƒ­ãƒã‚¤ãƒ€ã‚¢ãƒ€ãƒ—ã‚¿ (Anthropic/OpenAI/Gemini)
â”‚       â”‚   â”œâ”€â”€ providers_auth.py # èªè¨¼ä»˜ããƒ—ãƒ­ãƒã‚¤ãƒ€
â”‚       â”‚   â””â”€â”€ auth/            # èªè¨¼ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« (OAuth/Copilot/Claude)
â”‚       â”œâ”€â”€ output/              # å‡ºåŠ›ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
â”‚       â”‚   â””â”€â”€ formatter.py     # OutputFormatter
â”‚       â”œâ”€â”€ plugins/             # ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚·ã‚¹ãƒ†ãƒ 
â”‚       â”‚   â”œâ”€â”€ loader.py        # PluginLoader
â”‚       â”‚   â”œâ”€â”€ executor.py      # CommandExecutor
â”‚       â”‚   â”œâ”€â”€ guard.py         # PluginGuard
â”‚       â”‚   â”œâ”€â”€ bridge.py        # BridgeAdapter (å¤–éƒ¨CLIé€£æº)
â”‚       â”‚   â”œâ”€â”€ permission_guard.py # ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä¸Šæ›¸ãæ¨©é™åˆ¶å¾¡
â”‚       â”‚   â””â”€â”€ signature.py     # ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ç½²åæ¤œè¨¼
â”‚       â”œâ”€â”€ security/            # ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£
â”‚       â”‚   â”œâ”€â”€ filter.py        # SecurityFilter
â”‚       â”‚   â””â”€â”€ guardrails.py    # GuardrailsAdapter
â”‚       â””â”€â”€ webui_backend/       # FastAPI WebUI (Preview)
â”‚           â”œâ”€â”€ app.py           # FastAPIã‚¢ãƒ—ãƒª
â”‚           â”œâ”€â”€ adapter.py       # WebUIã‚¢ãƒ€ãƒ—ã‚¿
â”‚           â”œâ”€â”€ session_manager.py # ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†
â”‚           â”œâ”€â”€ broadcaster.py   # WebSocketé…ä¿¡
â”‚           â””â”€â”€ models.py        # WebUIç”¨ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ unit/                    # ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ
â”‚   â”œâ”€â”€ property/                # ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãƒ™ãƒ¼ã‚¹ãƒ†ã‚¹ãƒˆ (Hypothesis)
â”‚   â”œâ”€â”€ integration/             # çµ±åˆãƒ†ã‚¹ãƒˆ
â”‚   â””â”€â”€ e2e/                     # ã‚¨ãƒ³ãƒ‰ãƒ„ãƒ¼ã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆ (Playwright)
â”œâ”€â”€ plugins/                     # ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
â”‚   â””â”€â”€ magi-cc-sdd-plugin/      # SDDãƒ—ãƒ©ã‚°ã‚¤ãƒ³
â”œâ”€â”€ .kiro/                       # SDDä»•æ§˜ãƒ»ã‚¹ãƒ†ã‚¢ãƒªãƒ³ã‚°
â”œâ”€â”€ docs/                        # ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
â”œâ”€â”€ pyproject.toml               # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨­å®š
â”œâ”€â”€ AGENTS.md                    # é–‹ç™ºã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³
â””â”€â”€ README.md                    # ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«
```

## ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```mermaid
graph TB
    subgraph "CLI Layer"
        CLI[MAGI CLI]
        ArgParser[Argument Parser]
    end

    subgraph "Core Engine"
        CE[Consensus Engine]
        TH[Thinking Phase]
        DB[Debate Phase]
        VT[Voting Phase]
    end

    subgraph "Agent System"
        PM[Persona Manager]
        MEL[MELCHIOR-1]
        BAL[BALTHASAR-2]
        CAS[CASPER-3]
    end

    subgraph "Plugin System"
        PL[Plugin Loader]
        CMD[Command Executor]
    end

    subgraph "Infrastructure"
        LLM[LLM Client]
        CM[Context Manager]
        CFG[Config Manager]
        OUT[Output Formatter]
    end

    CLI --> ArgParser
    ArgParser --> CE
    CE --> TH --> DB --> VT
    CE --> PM
    PM --> MEL & BAL & CAS
    MEL & BAL & CAS --> LLM
    CE --> CM
    PL --> PM
    PL --> CMD
    CFG --> CE & LLM
    CE --> OUT
```

## æŠ•ç¥¨çµæœã¨çµ‚äº†ã‚³ãƒ¼ãƒ‰

| æŠ•ç¥¨çµæœ | Exit Code | èª¬æ˜ |
|---------|-----------|------|
| APPROVE | 0 | å…¨å“¡ã¾ãŸã¯éåŠæ•°ãŒæ‰¿èª |
| DENY | 1 | å…¨å“¡ã¾ãŸã¯éåŠæ•°ãŒå¦æ±º |
| CONDITIONAL | 2 | æ¡ä»¶ä»˜ãæ‰¿èªï¼ˆæ¡ä»¶ã®è©³ç´°ãŒå‡ºåŠ›ã«å«ã¾ã‚Œã‚‹ï¼‰ |

## ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

MIT License

Copyright (c) 2024 MAGI System Contributors

## ã‚³ãƒ³ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³

ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚„èª²é¡Œã®å ±å‘Šã¯å¤§æ­“è¿ã§ã™ï¼

1. ãƒªãƒã‚¸ãƒˆãƒªã‚’ãƒ•ã‚©ãƒ¼ã‚¯
2. ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ãƒ–ãƒ©ãƒ³ãƒã‚’ä½œæˆ (`git checkout -b feature/amazing-feature`)
3. å¤‰æ›´ã‚’ã‚³ãƒŸãƒƒãƒˆ (`git commit -m 'Add some amazing feature'`)
4. ãƒ–ãƒ©ãƒ³ãƒã‚’ãƒ—ãƒƒã‚·ãƒ¥ (`git push origin feature/amazing-feature`)
5. ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ä½œæˆ

## é–¢é€£ãƒªãƒ³ã‚¯

- [Anthropic API Documentation](https://docs.anthropic.com/)
- [cc-sddï¼ˆä»•æ§˜æ›¸é§†å‹•é–‹ç™ºãƒ„ãƒ¼ãƒ«ï¼‰](https://github.com/yohi/cc-sdd)

---

<div align="center">

**"The three computers that govern NERV."**

</div>
